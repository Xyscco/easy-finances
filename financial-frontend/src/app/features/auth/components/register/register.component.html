<div class="form-container slide-in-up">
  <div class="form-header">
    <h2 class="form-title">Criar sua conta</h2>
    <p class="form-subtitle">Preencha os dados para começar</p>
  </div>

  <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
    <!-- Nome e Sobrenome -->
    <div class="form-row">
      <div class="form-group">
        <label class="form-label" for="primeiro_nome">
          <i nz-icon nzType="user" nzTheme="outline"></i>
          Nome
        </label>
        <nz-input-group nzPrefixIcon="user">
          <input
            nz-input
            id="primeiro_nome"
            type="text"
            placeholder="Seu nome"
            formControlName="primeiro_nome"
            class="form-input"
            [class.error]="getFieldError('primeiro_nome')"
          />
        </nz-input-group>
        <span class="error-message" *ngIf="getFieldError('primeiro_nome')">
          {{ getFieldError('primeiro_nome') }}
        </span>
      </div>

      <div class="form-group">
        <label class="form-label" for="ultimo_nome">
          <i nz-icon nzType="user" nzTheme="outline"></i>
          Sobrenome
        </label>
        <nz-input-group nzPrefixIcon="user">
          <input
            nz-input
            id="ultimo_nome"
            type="text"
            placeholder="Seu sobrenome"
            formControlName="ultimo_nome"
            class="form-input"
            [class.error]="getFieldError('ultimo_nome')"
          />
        </nz-input-group>
                <span class="error-message" *ngIf="getFieldError('ultimo_nome')">
          {{ getFieldError('ultimo_nome') }}
        </span>
      </div>
    </div>

    <!-- Email -->
    <div class="form-group">
      <label class="form-label" for="email">
        <i nz-icon nzType="mail" nzTheme="outline"></i>
        Email
      </label>
      <nz-input-group nzPrefixIcon="mail">
        <input
          nz-input
          id="email"
          type="email"
          placeholder="seu@email.com"
          formControlName="email"
          class="form-input"
          [class.error]="getFieldError('email')"
        />
      </nz-input-group>
      <span class="error-message" *ngIf="getFieldError('email')">
        {{ getFieldError('email') }}
      </span>
    </div>

    <!-- Telefone -->
    <div class="form-group">
      <label class="form-label" for="telefone">
        <i nz-icon nzType="phone" nzTheme="outline"></i>
        Telefone (opcional)
      </label>
      <nz-input-group nzPrefixIcon="phone">
        <input
          nz-input
          id="telefone"
          type="tel"
          placeholder="(11) 99999-9999"
          formControlName="telefone"
          class="form-input"
          [class.error]="getFieldError('telefone')"
          (input)="formatPhone($event)"
        />
      </nz-input-group>
      <span class="error-message" *ngIf="getFieldError('telefone')">
        {{ getFieldError('telefone') }}
      </span>
    </div>

    <!-- Senha -->
    <div class="form-group">
      <label class="form-label" for="senha">
        <i nz-icon nzType="lock" nzTheme="outline"></i>
        Senha
      </label>
      <nz-input-group nzPrefixIcon="lock" [nzSuffix]="passwordSuffixTemplate">
        <input
          nz-input
          id="senha"
          [type]="passwordVisible ? 'text' : 'password'"
          placeholder="Digite uma senha segura"
          formControlName="senha"
          class="form-input"
          [class.error]="getFieldError('senha')"
        />
      </nz-input-group>
      <ng-template #passwordSuffixTemplate>
        <i
          nz-icon
          [nzType]="passwordVisible ? 'eye-invisible' : 'eye'"
          (click)="passwordVisible = !passwordVisible"
          class="password-toggle"
        ></i>
      </ng-template>
      
      <!-- Password Strength Indicator -->
      <div class="password-strength" *ngIf="registerForm.get('senha')?.value">
        <div class="strength-bar">
          <div 
            class="strength-fill" 
            [style.width.%]="getPasswordStrength().strength"
            [style.background-color]="getPasswordStrength().color"
          ></div>
        </div>
        <span class="strength-text" [style.color]="getPasswordStrength().color">
          {{ getPasswordStrength().text }}
        </span>
      </div>
      
      <span class="error-message" *ngIf="getFieldError('senha')">
        {{ getFieldError('senha') }}
      </span>
    </div>

    <!-- Confirmar Senha -->
    <div class="form-group">
      <label class="form-label" for="confirmar_senha">
        <i nz-icon nzType="lock" nzTheme="outline"></i>
        Confirmar Senha
      </label>
      <nz-input-group nzPrefixIcon="lock" [nzSuffix]="confirmPasswordSuffixTemplate">
        <input
          nz-input
          id="confirmar_senha"
          [type]="confirmPasswordVisible ? 'text' : 'password'"
          placeholder="Confirme sua senha"
          formControlName="confirmar_senha"
          class="form-input"
          [class.error]="getFieldError('confirmar_senha')"
        />
      </nz-input-group>
      <ng-template #confirmPasswordSuffixTemplate>
        <i
          nz-icon
          [nzType]="confirmPasswordVisible ? 'eye-invisible' : 'eye'"
          (click)="confirmPasswordVisible = !confirmPasswordVisible"
          class="password-toggle"
        ></i>
      </ng-template>
      <span class="error-message" *ngIf="getFieldError('confirmar_senha')">
        {{ getFieldError('confirmar_senha') }}
      </span>
    </div>

    <!-- Termos de Uso -->
    <div class="form-group">
      <label nz-checkbox formControlName="aceitar_termos" class="terms-checkbox">
        Eu aceito os 
        <a href="#" class="terms-link">Termos de Uso</a> 
        e 
        <a href="#" class="terms-link">Política de Privacidade</a>
      </label>
      <span class="error-message" *ngIf="getFieldError('aceitar_termos')">
        {{ getFieldError('aceitar_termos') }}
      </span>
    </div>

    <!-- Submit Button -->
    <button
      nz-button
      nzType="primary"
      nzSize="large"
      [nzLoading]="loading"
      [disabled]="loading"
      class="btn-primary"
      type="submit"
    >
      <span *ngIf="!loading">
        <i nz-icon nzType="user-add" nzTheme="outline"></i>
        Criar Conta
      </span>
      <span *ngIf="loading">Criando conta...</span>
    </button>

    <!-- Switch to Login -->
    <div class="switch-form">
      <span>Já tem uma conta? </span>
      <a (click)="onSwitchToLogin()" class="switch-link">
        Fazer login
      </a>
    </div>
  </form>
</div>